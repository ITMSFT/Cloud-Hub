<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GitHub Styled Page</title>
    <link href="stylebootstrap.css" rel="stylesheet">
    <link href="styles.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
</head>
<body>
    <div class="background">
        <video autoplay muted loop id="bg-video">
            <source src="bgvideo.mp4" type="video/mp4">
            Ваш браузер не поддерживает тег видео.
        </video>
    </div>
    <div class="content">
        <div class="container mt-5">
            <div class="row mb-3">
                <div class="col-md-auto">
                    <div class="translucent-box small-box">
                        <h3 class="box-title">
                            <span class="logo-part1">ITMSFT Group</span> | 
                            <span class="logo-part2">Support</span>
                        </h3>
                    </div>
                </div>
                <div class="col-md-auto ml-auto">
                    <div class="translucent-box small-box">
                        <h3 class="box-title">Language</h3>
                        <!-- Селекторы выбора языка или другие элементы -->
                    </div>
                </div>
            </div>
            <div class="row mb-3">
                <div class="col-md-4">
                    <div class="translucent-box">
                        <h3 class="box-title">Контакты поддержки</h3>
                        <pre><code>
<span class="terminal-text yellow">Телефон: <a class="yellow" href="tel:+380487063848">+38 (048) 706-38-48</a></span>
<span class="terminal-text yellow">Резервная линия: <a class="yellow" href="tel:+380487016551">+38 (048) 701-65-51</a></span>
<span class="terminal-text red">Email: <a class="red" href="mailto:mail@itmsft.net">mail@itmsft.net</a></span>
                        </code></pre>
                        <div class="button-group-small">
                            <button type="button" class="btn btn-small btn-outline-light" onclick="window.location.href='https://itmsft.com/helpdesk/my/new/5/'">Создать запрос</button>
                            <button type="button" class="btn btn-small btn-outline-light" onclick="window.location.href='https://itmsft.com/helpdesk/my/'">Мои запросы</button>
                        </div>
                        <div class="messenger-icons">
                            <a href="https://t.me/itmsft_bot" class="messenger-icon"><i class="fab fa-telegram-plane"></i></a>
                            <a href="viber://pa?chatURI=itmsft" class="messenger-icon"><i class="fab fa-viber"></i></a>
                            <a href="https://www.facebook.com/messages/t/itmsftgroup" class="messenger-icon"><i class="fab fa-facebook-messenger"></i></a>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="translucent-box">
                        <h3 class="box-title">HEARTBEAT СЛУЖБ</h3>
                        <pre><code id="heartbeat-services">Loading...</code></pre>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="translucent-box">
                        <h3 class="box-title">Облачная инфраструктура</h3>
                        <table>
                            <tr>
                                <th class="yellow-text">Описание</th>
                                <th class="green-text">Состояние</th>
                            </tr>
                            <tr>
                                <td class="yellow-text">Основной:</td>
                                <td class="green-text" id="mainServerStatus">Проверка...</td>
                            </tr>
                            <tr>
                                <td class="yellow-text">Резервный:</td>
                                <td class="green-text" id="reserveServerStatus">Проверка...</td>
                            </tr>
                            <tr>
                                <td class="yellow-text">Репликация:</td>
                                <td class="green-text" id="syncStatus">Неизвестно</td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>
            <div class="row mb-3">
                <div class="col-12">
                    <div class="translucent-box large-box">
                        <h3 class="box-title">Панели управления</h3>
                        <div class="button-group">
                            <button type="button" class="btn btn-primary m-2" id="hostingPanelButton">Хостинг панель</button>
                            <button type="button" class="btn btn-primary m-2" onclick="window.location.href='https://portal.azure.com/'">Azure</button>
                            <button type="button" class="btn btn-primary m-2" onclick="window.location.href='https://admin.microsoft.com/'">Microsoft 365</button>
                            <button type="button" class="btn btn-success m-2" onclick="window.location.href='https://outlook.office.com/'">Электронная почта</button>
                            <button type="button" class="btn btn-success m-2" onclick="window.location.href='https://cloud.itmsft.net:90/ucp/'">Телефония</button>
                            <button type="button" class="btn btn-secondary m-2" onclick="window.location.href='https://itmsft.com/my/'">Личный кабинет</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-6">
                    <div class="translucent-box">
                        <h3 class="box-title">Новости платформы</h3>
                        <pre><code id="platform-news">Loading...</code></pre>
                        <button type="button" class="btn btn-outline-light" onclick="window.location.href='https://itmsft.com/blog/'">Все новости</button>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="translucent-box">
                        <h3 class="box-title">Уведомления</h3>
                        <pre><code id="platform-notifications">Loading...</code></pre>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-12">
                    <div class="translucent-box">
                        <h3 class="box-title">Текущий клиент: John Doe</h3>
                        <div class="button-group">
                            <button type="button" class="btn btn-outline-light m-2" onclick="window.location.href='https://domain.com/'">Открыть сайт</button>
                            <button type="button" class="btn btn-outline-light m-2" id="clientPanelButton">Открыть панель</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>
        // Функция для загрузки и отображения содержимого файла
        async function loadHeartbeatServices() {
            try {
                const response = await fetch('services.txt');
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                const text = await response.text();
                document.getElementById('heartbeat-services').innerText = text;
            } catch (error) {
                document.getElementById('heartbeat-services').innerText = 'Ошибка загрузки данных';
            }
        }

        // Функция для загрузки и отображения новостей
        async function loadPlatformNews() {
            try {
                const response = await fetch('news.txt');
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                const text = await response.text();
                document.getElementById('platform-news').innerText = text;
            } catch (error) {
                document.getElementById('platform-news').innerText = 'Ошибка загрузки данных';
            }
        }

        // Функция для загрузки и отображения уведомлений
        async function loadPlatformNotifications() {
            try {
                const response = await fetch('notifications.txt');
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                const text = await response.text();
                document.getElementById('platform-notifications').innerText = text;
            } catch (error) {
                document.getElementById('platform-notifications').innerText = 'Ошибка загрузки данных';
            }
        }

        // Функция для проверки состояния серверов
        function checkServer(url, callback) {
            const img = new Image();
            img.onload = function() { callback(true); };
            img.onerror = function() { callback(false); };
            img.src = url + "/favicon.ico?" + new Date().getTime();
        }

        function checkServers() {
            const servers = [
                { url: "https://cloud.itmsft.net", name: "Основной", statusId: "mainServerStatus" },
                { url: "https://reserve.itmsft.net", name: "Резервный", statusId: "reserveServerStatus" }
            ];

            let mainDatacenterOnline = false;
            let reserveDatacenterOnline = false;

            servers.forEach(server => {
                checkServer(server.url, function(isOnline) {
                    const statusElement = document.getElementById(server.statusId);
                    
                    if (isOnline) {
                        statusElement.textContent = "Активен";
                        
                        if (server.name === "Основной") mainDatacenterOnline = true;
                        if (server.name === "Резервный") reserveDatacenterOnline = true;
                    } else {
                        statusElement.textContent = "Гибернация";
                    }

                    updateSyncStatus(mainDatacenterOnline, reserveDatacenterOnline);
                });
            });

            // Обновляем ссылку кнопки в зависимости от состояния сервера
            const hostingPanelButton = document.getElementById('hostingPanelButton');
            hostingPanelButton.addEventListener('click', function() {
                if (mainDatacenterOnline) {
                    window.location.href = 'https://cloud.itmsft.net';
                } else {
                    window.location.href = 'https://reserve.itmsft.net';
                }
            });

            // Обновляем ссылку кнопки панели клиента в зависимости от состояния сервера
            const clientPanelButton = document.getElementById('clientPanelButton');
            clientPanelButton.addEventListener('click', function() {
                if (mainDatacenterOnline) {
                    window.location.href = 'https://cloud.domain.com';
                } else {
                    window.location.href = 'https://reserve.domain.com';
                }
            });
        }

        function updateSyncStatus(mainOnline, reserveOnline) {
            const syncStatus = document.getElementById("syncStatus");

            if (mainOnline && !reserveOnline) {
                syncStatus.textContent = "Синхронизировано";
            } else if (!mainOnline && reserveOnline) {
                syncStatus.textContent = "Синхронизировано";
            } else if (mainOnline && reserveOnline) {
                syncStatus.textContent = "Идёт синхронизация";
            } else {
                syncStatus.textContent = "Неизвестно";
            }
        }

        function refreshPage() {
            location.reload();
        }

        // Запуск проверки при загрузке страницы
        window.onload = function() {
            loadHeartbeatServices();
            checkServers();
            loadPlatformNews(); // Загружаем новости платформы при загрузке страницы
            loadPlatformNotifications(); // Загружаем уведомления при загрузке страницы
        };
    </script>
</body>
</html>
